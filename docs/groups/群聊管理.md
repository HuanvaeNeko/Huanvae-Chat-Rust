# Groups ç¾¤èŠæ¥å£ï¼ˆFetch APIï¼‰

ç¾¤èŠç®¡ç†ç›¸å…³æ¥å£çš„å‰ç«¯è°ƒç”¨ç¤ºä¾‹ï¼Œä½¿ç”¨ Fetch APIã€‚

## ğŸ”§ é€šç”¨å·¥å…·å‡½æ•°

```js
const BASE = 'http://localhost';  // é€šè¿‡ Nginx ä»£ç†

/**
 * é€šç”¨ API è¯·æ±‚å°è£…
 * @param {string} path - API è·¯å¾„
 * @param {object} options - è¯·æ±‚é€‰é¡¹
 */
async function api(path, { method='GET', token, body, formData }={}) {
  const headers = {};
  
  if (body) {
    headers['Content-Type'] = 'application/json';
  }
  
  if (token) {
    headers['Authorization'] = `Bearer ${token}`;
  }
  
  const options = {
    method,
    headers,
    body: formData || (body ? JSON.stringify(body) : undefined)
  };
  
  const res = await fetch(`${BASE}${path}`, options);
  const data = await res.json().catch(() => ({}));
  
  if (!res.ok) {
    throw new Error(`${res.status} ${JSON.stringify(data)}`);
  }
  
  return data;
}
```

---

## ğŸ“‹ æ¥å£åˆ—è¡¨

### ä¸€ã€ç¾¤èŠåŸºç¡€æ“ä½œ

#### 1. åˆ›å»ºç¾¤èŠ

**ç«¯ç‚¹**ï¼š`POST /api/groups`

**åŠŸèƒ½**ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç¾¤èŠï¼Œåˆ›å»ºè€…è‡ªåŠ¨æˆä¸ºç¾¤ä¸»

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  group_name: string,           // ç¾¤åç§°ï¼ˆå¿…å¡«ï¼‰
  group_description?: string,   // ç¾¤ç®€ä»‹ï¼ˆå¯é€‰ï¼‰
  join_mode?: string           // å…¥ç¾¤æ¨¡å¼ï¼ˆå¯é€‰ï¼Œé»˜è®¤ approval_requiredï¼‰
}
```

**å…¥ç¾¤æ¨¡å¼é€‰é¡¹**ï¼š
| å€¼ | è¯´æ˜ |
|---|---|
| `open` | å¼€æ”¾å…¥ç¾¤ï¼šæ‰€æœ‰æ–¹å¼å‡å¯ç›´æ¥è¿›å…¥ |
| `approval_required` | éœ€å®¡æ ¸ï¼šæ™®é€šæˆå‘˜é‚€è¯·å’Œæœç´¢å…¥ç¾¤éœ€å®¡æ ¸ï¼ˆé»˜è®¤ï¼‰ |
| `invite_only` | ä»…é‚€è¯·ï¼šåªèƒ½é€šè¿‡é‚€è¯·è¿›å…¥ |
| `admin_invite_only` | ä»…ç®¡ç†é‚€è¯·ï¼šåªèƒ½ç¾¤ä¸»/ç®¡ç†å‘˜é‚€è¯·è¿›å…¥ |
| `closed` | å…³é—­å…¥ç¾¤ï¼šä¸å…è®¸ä»»ä½•æ–°æˆå‘˜åŠ å…¥ |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const result = await api('/api/groups', {
  method: 'POST',
  token,
  body: {
    group_name: 'æˆ‘çš„ç¾¤èŠ',
    group_description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ç¾¤',
    join_mode: 'approval_required'
  }
});

console.log(result);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "group_id": "019ae4ec-0dfe-7ac1-966e-876e9755561c",
//     "group_name": "æˆ‘çš„ç¾¤èŠ",
//     "created_at": "2025-12-03T15:54:26.686987Z"
//   }
// }
```

---

#### 2. è·å–æˆ‘çš„ç¾¤èŠåˆ—è¡¨

**ç«¯ç‚¹**ï¼š`GET /api/groups/my`

**åŠŸèƒ½**ï¼šè·å–å½“å‰ç”¨æˆ·åŠ å…¥çš„æ‰€æœ‰ç¾¤èŠåˆ—è¡¨

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const myGroups = await api('/api/groups/my', { token });

console.log(myGroups);
// {
//   "success": true,
//   "code": 200,
//   "data": [
//     {
//       "group_id": "019ae4ec-0dfe-7ac1-966e-876e9755561c",
//       "group_name": "æµ‹è¯•ç¾¤èŠ",
//       "group_avatar_url": "",
//       "role": "owner",
//       "unread_count": 5,
//       "last_message_content": "å¤§å®¶å¥½",
//       "last_message_time": "2025-12-03T15:54:26.686987Z"
//     }
//   ]
// }
```

**å“åº”å­—æ®µè¯´æ˜**ï¼š
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `group_id` | UUID | ç¾¤èŠå”¯ä¸€æ ‡è¯† |
| `group_name` | string | ç¾¤åç§° |
| `group_avatar_url` | string | ç¾¤å¤´åƒURL |
| `role` | string | ç”¨æˆ·åœ¨ç¾¤ä¸­çš„è§’è‰²ï¼ˆowner/admin/memberï¼‰ |
| `unread_count` | number \| null | æœªè¯»æ¶ˆæ¯æ•°é‡ |
| `last_message_content` | string \| null | æœ€åä¸€æ¡æ¶ˆæ¯å†…å®¹ |
| `last_message_time` | string \| null | æœ€åä¸€æ¡æ¶ˆæ¯æ—¶é—´ |

---

#### 3. è·å–ç¾¤èŠè¯¦æƒ…

**ç«¯ç‚¹**ï¼š`GET /api/groups/{group_id}`

**åŠŸèƒ½**ï¼šè·å–æŒ‡å®šç¾¤èŠçš„è¯¦ç»†ä¿¡æ¯

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const groupInfo = await api(`/api/groups/${groupId}`, { token });

console.log(groupInfo);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "group_id": "019ae4ec-0dfe-7ac1-966e-876e9755561c",
//     "group_name": "æµ‹è¯•ç¾¤èŠ",
//     "group_avatar_url": "",
//     "group_description": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ç¾¤",
//     "creator_id": "user_a",
//     "created_at": "2025-12-03T15:54:26.686987Z",
//     "join_mode": "approval_required",
//     "status": "active",
//     "member_count": 5
//   }
// }
```

---

#### 4. æ›´æ–°ç¾¤èŠä¿¡æ¯

**ç«¯ç‚¹**ï¼š`PUT /api/groups/{group_id}`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  group_name?: string,         // æ–°ç¾¤åç§°
  group_description?: string,  // æ–°ç¾¤ç®€ä»‹
  group_avatar_url?: string    // æ–°å¤´åƒURL
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}`, {
  method: 'PUT',
  token,
  body: {
    group_name: 'æ–°ç¾¤å',
    group_description: 'æ›´æ–°åçš„ç¾¤ç®€ä»‹'
  }
});
```

---

#### 5. ä¸Šä¼ ç¾¤å¤´åƒ

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/avatar`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚æ ¼å¼**ï¼š`multipart/form-data`

**è¯·æ±‚å­—æ®µ**ï¼š
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `avatar` | File | å¤´åƒæ–‡ä»¶ï¼ˆæ”¯æŒ jpgã€pngã€gifã€webpï¼Œæœ€å¤§ 10MBï¼‰ |

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const fileInput = document.getElementById('avatarFile');
const file = fileInput.files[0];

const formData = new FormData();
formData.append('avatar', file);

const result = await api(`/api/groups/${groupId}/avatar`, {
  method: 'POST',
  token,
  formData
});

console.log(result);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "avatar_url": "http://localhost/avatars/group-019ae4ec-0dfe-7ac1-966e-876e9755561c.jpg"
//   }
// }
```

**HTML ç¤ºä¾‹**ï¼š
```html
<input type="file" id="avatarFile" accept="image/*">
<button onclick="uploadGroupAvatar()">ä¸Šä¼ </button>

<script>
async function uploadGroupAvatar() {
  const fileInput = document.getElementById('avatarFile');
  const file = fileInput.files[0];
  if (!file) {
    alert('è¯·é€‰æ‹©å›¾ç‰‡');
    return;
  }
  
  const formData = new FormData();
  formData.append('avatar', file);
  
  const res = await fetch(`${BASE}/api/groups/${groupId}/avatar`, {
    method: 'POST',
    headers: { 'Authorization': `Bearer ${token}` },
    body: formData
  });
  
  const data = await res.json();
  console.log('æ–°å¤´åƒURL:', data.data.avatar_url);
}
</script>
```

---

#### 6. ä¿®æ”¹æˆ‘çš„ç¾¤å†…æ˜µç§°

**ç«¯ç‚¹**ï¼š`PUT /api/groups/{group_id}/nickname`

**æƒé™**ï¼šç¾¤æˆå‘˜ï¼ˆæ¯ä¸ªæˆå‘˜åªèƒ½ä¿®æ”¹è‡ªå·±çš„ç¾¤å†…æ˜µç§°ï¼‰

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  nickname: string | null  // ç¾¤å†…æ˜µç§°ï¼Œä¼  null æˆ–ç©ºå­—ç¬¦ä¸²æ¸…é™¤æ˜µç§°
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
// è®¾ç½®ç¾¤å†…æ˜µç§°
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}/nickname`, {
  method: 'PUT',
  token,
  body: {
    nickname: 'ç¾¤ä¸»å¤§äºº'
  }
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "ç¾¤æ˜µç§°å·²æ›´æ–°"
//   }
// }
```

**æ¸…é™¤æ˜µç§°ç¤ºä¾‹**ï¼š
```js
// æ¸…é™¤ç¾¤å†…æ˜µç§°ï¼ˆä¼ ç©ºå­—ç¬¦ä¸²æˆ– nullï¼‰
await api(`/api/groups/${groupId}/nickname`, {
  method: 'PUT',
  token,
  body: {
    nickname: ''
  }
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "ç¾¤æ˜µç§°å·²æ¸…é™¤"
//   }
// }
```

**è¯´æ˜**ï¼š
- ç¾¤å†…æ˜µç§°ä»…åœ¨è¯¥ç¾¤å†…æ˜¾ç¤ºï¼Œä¸å½±å“ç”¨æˆ·çš„å…¨å±€æ˜µç§°
- å¦‚æœæœªè®¾ç½®ç¾¤å†…æ˜µç§°ï¼Œåˆ™æ˜¾ç¤ºç”¨æˆ·çš„å…¨å±€æ˜µç§°
- æ¸…é™¤æ˜µç§°åï¼Œç³»ç»Ÿå°†ä½¿ç”¨ç”¨æˆ·çš„å…¨å±€æ˜µç§°æ˜¾ç¤º

---

#### 7. ä¿®æ”¹å…¥ç¾¤æ¨¡å¼

**ç«¯ç‚¹**ï¼š`PUT /api/groups/{group_id}/join-mode`

**æƒé™**ï¼šä»…ç¾¤ä¸»

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  join_mode: string  // æ–°çš„å…¥ç¾¤æ¨¡å¼
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}/join-mode`, {
  method: 'PUT',
  token,
  body: {
    join_mode: 'invite_only'
  }
});
```

---

#### 8. è§£æ•£ç¾¤èŠ

**ç«¯ç‚¹**ï¼š`DELETE /api/groups/{group_id}`

**æƒé™**ï¼šä»…ç¾¤ä¸»

**åŠŸèƒ½**ï¼šè½¯åˆ é™¤ç¾¤èŠï¼Œä¿ç•™æ‰€æœ‰è®°å½•

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}`, {
  method: 'DELETE',
  token
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "ç¾¤èŠå·²è§£æ•£"
//   }
// }
```

---

### äºŒã€æˆå‘˜ç®¡ç†

#### 1. è·å–æˆå‘˜åˆ—è¡¨

**ç«¯ç‚¹**ï¼š`GET /api/groups/{group_id}/members`

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const members = await api(`/api/groups/${groupId}/members`, { token });

console.log(members);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "members": [
//       {
//         "user_id": "user_a",
//         "user_nickname": "ç”¨æˆ·A",
//         "user_avatar_url": "",
//         "role": "owner",
//         "group_nickname": null,
//         "joined_at": "2025-12-03T15:54:26.686987Z",
//         "join_method": "create",
//         "muted_until": null
//       }
//     ],
//     "total": 1
//   }
// }
```

---

#### 2. é‚€è¯·æˆå‘˜å…¥ç¾¤

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/invite`

**æƒé™**ï¼š
- ç¾¤ä¸»/ç®¡ç†å‘˜ï¼šè¢«é‚€è¯·è€…ç›´æ¥åŠ å…¥
- æ™®é€šæˆå‘˜ï¼šè¢«é‚€è¯·è€…éœ€è¦å®¡æ ¸

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  user_ids: string[],   // è¢«é‚€è¯·ç”¨æˆ·IDåˆ—è¡¨
  message?: string      // é‚€è¯·æ¶ˆæ¯ï¼ˆå¯é€‰ï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const result = await api(`/api/groups/${groupId}/invite`, {
  method: 'POST',
  token,
  body: {
    user_ids: ['user_b', 'user_c'],
    message: 'æ¬¢è¿åŠ å…¥æˆ‘ä»¬çš„ç¾¤èŠ'
  }
});

console.log(result);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "results": [
//       {
//         "user_id": "user_b",
//         "success": true,
//         "message": "é‚€è¯·å·²å‘é€ï¼Œå¾…å¯¹æ–¹åŒæ„"
//       }
//     ]
//   }
// }
```

---

#### 3. é€€å‡ºç¾¤èŠ

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/leave`

**æ³¨æ„**ï¼šç¾¤ä¸»ä¸èƒ½é€€å‡ºï¼Œéœ€å…ˆè½¬è®©ç¾¤ä¸»æˆ–è§£æ•£ç¾¤èŠ

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  reason?: string  // é€€å‡ºåŸå› ï¼ˆå¯é€‰ï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}/leave`, {
  method: 'POST',
  token,
  body: {
    reason: 'ä¸ªäººåŸå› '
  }
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "å·²é€€å‡ºç¾¤èŠ"
//   }
// }
```

---

#### 4. ç§»é™¤æˆå‘˜

**ç«¯ç‚¹**ï¼š`DELETE /api/groups/{group_id}/members/{user_id}`

**æƒé™**ï¼š
- ç¾¤ä¸»ï¼šå¯ç§»é™¤ä»»ä½•æˆå‘˜
- ç®¡ç†å‘˜ï¼šåªèƒ½ç§»é™¤æ™®é€šæˆå‘˜

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const userId = 'user_b';
await api(`/api/groups/${groupId}/members/${userId}`, {
  method: 'DELETE',
  token
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "æˆå‘˜å·²ç§»é™¤"
//   }
// }
```

---

### ä¸‰ã€è§’è‰²ç®¡ç†

#### 1. è½¬è®©ç¾¤ä¸»

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/transfer`

**æƒé™**ï¼šä»…ç¾¤ä¸»

**åŠŸèƒ½**ï¼š
- æ–°ç¾¤ä¸»ä»ç®¡ç†å‘˜/æ™®é€šæˆå‘˜å˜ä¸ºç¾¤ä¸»
- æ—§ç¾¤ä¸»å˜ä¸ºæ™®é€šæˆå‘˜

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  new_owner_id: string  // æ–°ç¾¤ä¸»ç”¨æˆ·ID
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}/transfer`, {
  method: 'POST',
  token,
  body: {
    new_owner_id: 'user_b'
  }
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "ç¾¤ä¸»å·²è½¬è®©"
//   }
// }
```

---

#### 2. è®¾ç½®ç®¡ç†å‘˜

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/admins`

**æƒé™**ï¼šä»…ç¾¤ä¸»

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  user_id: string  // è¦è®¾ç½®ä¸ºç®¡ç†å‘˜çš„ç”¨æˆ·ID
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}/admins`, {
  method: 'POST',
  token,
  body: {
    user_id: 'user_b'
  }
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "å·²è®¾ç½®ä¸ºç®¡ç†å‘˜"
//   }
// }
```

---

#### 3. å–æ¶ˆç®¡ç†å‘˜

**ç«¯ç‚¹**ï¼š`DELETE /api/groups/{group_id}/admins/{user_id}`

**æƒé™**ï¼šä»…ç¾¤ä¸»

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const userId = 'user_b';
await api(`/api/groups/${groupId}/admins/${userId}`, {
  method: 'DELETE',
  token
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "å·²å–æ¶ˆç®¡ç†å‘˜"
//   }
// }
```

---

### å››ã€ç¦è¨€ç®¡ç†

#### 1. ç¦è¨€æˆå‘˜

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/mute`

**æƒé™**ï¼š
- ç¾¤ä¸»ï¼šå¯ç¦è¨€ä»»ä½•æˆå‘˜
- ç®¡ç†å‘˜ï¼šåªèƒ½ç¦è¨€æ™®é€šæˆå‘˜

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  user_id: string,      // è¦ç¦è¨€çš„ç”¨æˆ·ID
  duration_minutes: number  // ç¦è¨€æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
await api(`/api/groups/${groupId}/mute`, {
  method: 'POST',
  token,
  body: {
    user_id: 'user_b',
    duration_minutes: 60  // ç¦è¨€ 1 å°æ—¶
  }
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "å·²ç¦è¨€",
//     "muted_until": "2025-12-03T16:54:26.686987Z"
//   }
// }
```

---

#### 2. è§£é™¤ç¦è¨€

**ç«¯ç‚¹**ï¼š`DELETE /api/groups/{group_id}/mute/{user_id}`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const userId = 'user_b';
await api(`/api/groups/${groupId}/mute/${userId}`, {
  method: 'DELETE',
  token
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "å·²è§£é™¤ç¦è¨€"
//   }
// }
```

---

### äº”ã€é‚€è¯·ç ç®¡ç†

#### 1. ç”Ÿæˆé‚€è¯·ç 

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/invite-codes`

**æƒé™**ï¼š
- ç¾¤ä¸»/ç®¡ç†å‘˜ï¼šç”Ÿæˆ"ç›´é€š"é‚€è¯·ç ï¼ˆdirectï¼‰ï¼Œä½¿ç”¨è€…å¯ç›´æ¥å…¥ç¾¤
- æ™®é€šæˆå‘˜ï¼šç”Ÿæˆ"æ™®é€š"é‚€è¯·ç ï¼ˆnormalï¼‰ï¼Œä½¿ç”¨è€…éœ€å®¡æ ¸

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  max_uses?: number,       // æœ€å¤§ä½¿ç”¨æ¬¡æ•°ï¼ˆå¯é€‰ï¼Œé»˜è®¤ 1ï¼‰
  expires_in_hours?: number  // æœ‰æ•ˆæœŸï¼ˆå°æ—¶ï¼Œå¯é€‰ï¼Œé»˜è®¤ 24ï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const result = await api(`/api/groups/${groupId}/invite-codes`, {
  method: 'POST',
  token,
  body: {
    max_uses: 10,
    expires_in_hours: 48
  }
});

console.log(result);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "id": "019ae4f0-c860-7570-842b-348c48552a1b",
//     "code": "wD14KR1K",
//     "code_type": "direct",
//     "expires_at": "2025-12-05T15:59:36.544750Z"
//   }
// }
```

---

#### 2. è·å–é‚€è¯·ç åˆ—è¡¨

**ç«¯ç‚¹**ï¼š`GET /api/groups/{group_id}/invite-codes`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const codes = await api(`/api/groups/${groupId}/invite-codes`, { token });
```

---

#### 3. æ’¤é”€é‚€è¯·ç 

**ç«¯ç‚¹**ï¼š`DELETE /api/groups/{group_id}/invite-codes/{code_id}`

**æƒé™**ï¼šé‚€è¯·ç åˆ›å»ºè€…æˆ–ç¾¤ä¸»/ç®¡ç†å‘˜

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const codeId = '019ae4f0-c860-7570-842b-348c48552a1b';
await api(`/api/groups/${groupId}/invite-codes/${codeId}`, {
  method: 'DELETE',
  token
});
```

---

#### 4. é€šè¿‡é‚€è¯·ç å…¥ç¾¤

**ç«¯ç‚¹**ï¼š`POST /api/groups/join-by-code`

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  code: string  // é‚€è¯·ç 
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const result = await api('/api/groups/join-by-code', {
  method: 'POST',
  token,
  body: {
    code: 'wD14KR1K'
  }
});

console.log(result);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "å·²æˆåŠŸåŠ å…¥ç¾¤èŠ"
//   }
// }
```

---

### å…­ã€å…¥ç¾¤ç”³è¯·

#### 1. ç”³è¯·å…¥ç¾¤ï¼ˆæœç´¢æ–¹å¼ï¼‰

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/apply`

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  message?: string  // ç”³è¯·æ¶ˆæ¯ï¼ˆå¯é€‰ï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const result = await api(`/api/groups/${groupId}/apply`, {
  method: 'POST',
  token,
  body: {
    message: 'ä½ å¥½ï¼Œæˆ‘æƒ³åŠ å…¥è¿™ä¸ªç¾¤'
  }
});
```

---

#### 2. è·å–æ”¶åˆ°çš„é‚€è¯·

**ç«¯ç‚¹**ï¼š`GET /api/groups/invitations`

**åŠŸèƒ½**ï¼šè·å–ç”¨æˆ·æ”¶åˆ°çš„æ‰€æœ‰ç¾¤èŠé‚€è¯·

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const invitations = await api('/api/groups/invitations', { token });

console.log(invitations);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "invitations": [
//       {
//         "request_id": "019ae4ec-7a9e-77a3-82f4-98ca71fc97de",
//         "group_id": "019ae4ec-0dfe-7ac1-966e-876e9755561c",
//         "group_name": "æµ‹è¯•ç¾¤èŠ",
//         "group_avatar_url": "",
//         "inviter_id": "user_a",
//         "inviter_nickname": "ç”¨æˆ·A",
//         "message": "æ¬¢è¿åŠ å…¥",
//         "created_at": "2025-12-03T15:54:54.494997Z",
//         "expires_at": "2025-12-10T15:54:54.494997Z"
//       }
//     ]
//   }
// }
```

---

#### 3. æ¥å—é‚€è¯·

**ç«¯ç‚¹**ï¼š`POST /api/groups/invitations/{request_id}/accept`

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const requestId = '019ae4ec-7a9e-77a3-82f4-98ca71fc97de';
await api(`/api/groups/invitations/${requestId}/accept`, {
  method: 'POST',
  token
});

// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "success": true,
//     "message": "å·²æˆåŠŸåŠ å…¥ç¾¤èŠ"
//   }
// }
```

---

#### 4. æ‹’ç»é‚€è¯·

**ç«¯ç‚¹**ï¼š`POST /api/groups/invitations/{request_id}/decline`

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const requestId = '019ae4ec-7a9e-77a3-82f4-98ca71fc97de';
await api(`/api/groups/invitations/${requestId}/decline`, {
  method: 'POST',
  token
});
```

---

#### 5. è·å–å¾…å¤„ç†ç”³è¯·ï¼ˆç®¡ç†å‘˜ï¼‰

**ç«¯ç‚¹**ï¼š`GET /api/groups/{group_id}/requests`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const requests = await api(`/api/groups/${groupId}/requests`, { token });
```

---

#### 6. åŒæ„ç”³è¯·

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/requests/{request_id}/approve`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const requestId = '019ae4ec-xxxx';
await api(`/api/groups/${groupId}/requests/${requestId}/approve`, {
  method: 'POST',
  token
});
```

---

#### 7. æ‹’ç»ç”³è¯·

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/requests/{request_id}/reject`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  reason?: string  // æ‹’ç»åŸå› ï¼ˆå¯é€‰ï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const requestId = '019ae4ec-xxxx';
await api(`/api/groups/${groupId}/requests/${requestId}/reject`, {
  method: 'POST',
  token,
  body: {
    reason: 'ä¸ç¬¦åˆå…¥ç¾¤æ¡ä»¶'
  }
});
```

---

### ä¸ƒã€ç¾¤å…¬å‘Š

#### 1. å‘å¸ƒå…¬å‘Š

**ç«¯ç‚¹**ï¼š`POST /api/groups/{group_id}/notices`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  title: string,      // å…¬å‘Šæ ‡é¢˜
  content: string,    // å…¬å‘Šå†…å®¹
  is_pinned?: boolean // æ˜¯å¦ç½®é¡¶ï¼ˆå¯é€‰ï¼Œé»˜è®¤ falseï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const result = await api(`/api/groups/${groupId}/notices`, {
  method: 'POST',
  token,
  body: {
    title: 'æ¬¢è¿æ–°æˆå‘˜',
    content: 'æ¬¢è¿å¤§å®¶åŠ å…¥ç¾¤èŠï¼',
    is_pinned: true
  }
});

console.log(result);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "id": "019ae4ed-38de-7bf2-b408-19033e450ba9",
//     "published_at": "2025-12-03T15:55:43.198074Z"
//   }
// }
```

---

#### 2. è·å–å…¬å‘Šåˆ—è¡¨

**ç«¯ç‚¹**ï¼š`GET /api/groups/{group_id}/notices`

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const notices = await api(`/api/groups/${groupId}/notices`, { token });

console.log(notices);
// {
//   "success": true,
//   "code": 200,
//   "data": {
//     "notices": [
//       {
//         "id": "019ae4ed-38de-7bf2-b408-19033e450ba9",
//         "title": "æ¬¢è¿æ–°æˆå‘˜",
//         "content": "æ¬¢è¿å¤§å®¶åŠ å…¥ç¾¤èŠï¼",
//         "publisher_id": "user_a",
//         "publisher_nickname": "ç”¨æˆ·A",
//         "published_at": "2025-12-03T15:55:43.198074Z",
//         "is_pinned": true,
//         "updated_at": "2025-12-03T15:55:43.198610Z"
//       }
//     ]
//   }
// }
```

---

#### 3. æ›´æ–°å…¬å‘Š

**ç«¯ç‚¹**ï¼š`PUT /api/groups/{group_id}/notices/{notice_id}`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ä½“**ï¼š
```typescript
{
  title?: string,      // æ–°æ ‡é¢˜
  content?: string,    // æ–°å†…å®¹
  is_pinned?: boolean  // æ˜¯å¦ç½®é¡¶
}
```

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const noticeId = '019ae4ed-38de-7bf2-b408-19033e450ba9';
await api(`/api/groups/${groupId}/notices/${noticeId}`, {
  method: 'PUT',
  token,
  body: {
    title: 'æ›´æ–°åçš„æ ‡é¢˜',
    is_pinned: false
  }
});
```

---

#### 4. åˆ é™¤å…¬å‘Š

**ç«¯ç‚¹**ï¼š`DELETE /api/groups/{group_id}/notices/{notice_id}`

**æƒé™**ï¼šç¾¤ä¸»æˆ–ç®¡ç†å‘˜

**è¯·æ±‚ç¤ºä¾‹**ï¼š
```js
const groupId = '019ae4ec-0dfe-7ac1-966e-876e9755561c';
const noticeId = '019ae4ed-38de-7bf2-b408-19033e450ba9';
await api(`/api/groups/${groupId}/notices/${noticeId}`, {
  method: 'DELETE',
  token
});
```

---

## ğŸ” æƒé™æ§åˆ¶æ€»ç»“

| æ“ä½œ | ç¾¤ä¸» | ç®¡ç†å‘˜ | æ™®é€šæˆå‘˜ |
|------|-----|-------|---------|
| ä¿®æ”¹ç¾¤åç§°/ç®€ä»‹ | âœ… | âœ… | âŒ |
| ä¸Šä¼ ç¾¤å¤´åƒ | âœ… | âœ… | âŒ |
| ä¿®æ”¹è‡ªå·±çš„ç¾¤å†…æ˜µç§° | âœ… | âœ… | âœ… |
| ä¿®æ”¹å…¥ç¾¤æ¨¡å¼ | âœ… | âŒ | âŒ |
| é‚€è¯·æˆå‘˜ï¼ˆç›´æ¥ï¼‰ | âœ… | âœ… | âŒ |
| é‚€è¯·æˆå‘˜ï¼ˆéœ€å®¡æ ¸ï¼‰ | - | - | âœ… |
| ç”Ÿæˆç›´é€šé‚€è¯·ç  | âœ… | âœ… | âŒ |
| ç”Ÿæˆæ™®é€šé‚€è¯·ç  | âœ… | âœ… | âœ… |
| å®¡æ ¸å…¥ç¾¤ç”³è¯· | âœ… | âœ… | âŒ |
| è®¾ç½®ç®¡ç†å‘˜ | âœ… | âŒ | âŒ |
| ç§»é™¤æˆå‘˜ | âœ… | âœ…ï¼ˆä¸èƒ½ç§»é™¤ç®¡ç†å‘˜ï¼‰ | âŒ |
| ç¦è¨€æˆå‘˜ | âœ… | âœ…ï¼ˆä¸èƒ½ç¦è¨€ç®¡ç†å‘˜ï¼‰ | âŒ |
| å‘å¸ƒå…¬å‘Š | âœ… | âœ… | âŒ |
| è½¬è®©ç¾¤ä¸» | âœ… | âŒ | âŒ |
| è§£æ•£ç¾¤èŠ | âœ… | âŒ | âŒ |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç¾¤ä¸»é™åˆ¶**ï¼šç¾¤ä¸»ä¸èƒ½é€€å‡ºç¾¤èŠï¼Œéœ€å…ˆè½¬è®©ç¾¤ä¸»æˆ–è§£æ•£ç¾¤èŠ
2. **è½¯åˆ é™¤**ï¼šè§£æ•£ç¾¤èŠæ˜¯è½¯åˆ é™¤ï¼Œä¿ç•™æ‰€æœ‰å†å²è®°å½•
3. **é‚€è¯·ç ç±»å‹**ï¼š
   - `direct`ï¼šç¾¤ä¸»/ç®¡ç†å‘˜ç”Ÿæˆï¼Œä½¿ç”¨è€…å¯ç›´æ¥å…¥ç¾¤
   - `normal`ï¼šæ™®é€šæˆå‘˜ç”Ÿæˆï¼Œä½¿ç”¨è€…éœ€è¦å®¡æ ¸
4. **å…¥ç¾¤æ–¹å¼è®°å½•**ï¼šç³»ç»Ÿä¼šè®°å½•æ¯ä¸ªæˆå‘˜çš„å…¥ç¾¤æ–¹å¼
5. **è½¬è®©ç¾¤ä¸»**ï¼šæ–°ç¾¤ä¸»å¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œä¼šä»ç®¡ç†å‘˜å˜ä¸ºç¾¤ä¸»ï¼›æ—§ç¾¤ä¸»å˜ä¸ºæ™®é€šæˆå‘˜

