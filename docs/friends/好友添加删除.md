# Friends 接口（Fetch API）

```js
const BASE = 'http://localhost:8080';
async function api(path, { method='GET', token, body }={}) {
  const headers = { 'Content-Type': 'application/json' };
  if (token) headers['Authorization'] = `Bearer ${token}`;
  const res = await fetch(`${BASE}${path}`, { method, headers, body: body ? JSON.stringify(body) : undefined });
  const data = await res.json().catch(() => ({}));
  if (!res.ok) throw new Error(`${res.status} ${JSON.stringify(data)}`);
  return data;
}
```

## 提交好友请求（受保护）
- 路径：`POST /api/friends/requests`
- 请求体：`{ user_id, target_user_id, reason?, request_time }`
```js
await api('/api/friends/requests', {
  method: 'POST', token,
  body: { user_id: 'u1', target_user_id: 'u2', reason: '加个好友吧', request_time: new Date().toISOString() }
});
```

## 同意好友请求（受保护）
- 路径：`POST /api/friends/requests/approve`
- 请求体：`{ user_id, applicant_user_id, approved_time, approved_reason? }`
```js
await api('/api/friends/requests/approve', {
  method: 'POST', token,
  body: { user_id: 'u2', applicant_user_id: 'u1', approved_time: new Date().toISOString(), approved_reason: '通过' }
});
```

## 拒绝好友请求（受保护）
- 路径：`POST /api/friends/requests/reject`
- 请求体：`{ user_id, applicant_user_id, reject_reason? }`
```js
await api('/api/friends/requests/reject', {
  method: 'POST', token,
  body: { user_id: 'u2', applicant_user_id: 'u1', reject_reason: '暂不需要' }
});
```

## 删除好友（标记结束，受保护）
- 路径：`POST /api/friends/remove`
- 请求体：`{ user_id, friend_user_id, remove_time, remove_reason? }`
```js
await api('/api/friends/remove', {
  method: 'POST', token,
  body: { user_id: 'u1', friend_user_id: 'u2', remove_time: new Date().toISOString(), remove_reason: '不常联系' }
});
```

## 列表查询（受保护）
- 已发送：`GET /api/friends/requests/sent`
```js
await api('/api/friends/requests/sent', { token });
```
- 待处理：`GET /api/friends/requests/pending`
```js
await api('/api/friends/requests/pending', { token });
```
- 已拥有：`GET /api/friends`
```js
await api('/api/friends', { token });
```
